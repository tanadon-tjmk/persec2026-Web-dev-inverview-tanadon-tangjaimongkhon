<!doctype html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Q3 - Autocomplete</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
        min-height: 100vh;
        color: #e0e0e0;
        padding: 40px 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .back-link {
        align-self: flex-start;
        max-width: 800px;
        width: 100%;
        margin: 0 auto 24px;
        color: #a78bfa;
        text-decoration: none;
        font-size: 0.95rem;
        transition: color 0.2s;
      }
      .back-link:hover {
        color: #c4b5fd;
      }

      .container {
        max-width: 800px;
        width: 100%;
      }

      h1 {
        font-size: 2rem;
        margin-bottom: 8px;
        background: linear-gradient(90deg, #a78bfa, #60a5fa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .description {
        color: #94a3b8;
        line-height: 1.7;
        margin-bottom: 32px;
        font-size: 1rem;
      }

      label {
        display: block;
        color: #cbd5e1;
        font-size: 0.9rem;
        margin-bottom: 6px;
        font-weight: 500;
      }

      .form-group {
        margin-bottom: 16px;
      }

      input[type="text"],
      input[type="number"] {
        width: 100%;
        padding: 12px 16px;
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.15);
        background: rgba(255, 255, 255, 0.06);
        color: #f1f5f9;
        font-size: 1rem;
        font-family: "Consolas", "Courier New", monospace;
        outline: none;
        transition: border-color 0.2s;
      }
      input:focus {
        border-color: #a78bfa;
      }
      input::placeholder {
        color: #64748b;
      }

      .hint {
        color: #64748b;
        font-size: 0.82rem;
        margin-top: 4px;
      }

      .btn-row {
        display: flex;
        gap: 12px;
        margin-top: 24px;
        margin-bottom: 24px;
      }

      button {
        padding: 12px 28px;
        border-radius: 12px;
        border: none;
        background: linear-gradient(135deg, #a78bfa, #7c3aed);
        color: #fff;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition:
          opacity 0.2s,
          transform 0.15s;
        white-space: nowrap;
      }
      button:hover:not(:disabled) {
        opacity: 0.9;
        transform: translateY(-1px);
      }
      button:active:not(:disabled) {
        transform: translateY(0);
      }
      button:disabled {
        background: rgba(255, 255, 255, 0.08);
        color: #64748b;
        cursor: not-allowed;
      }

      .result {
        padding: 20px 24px;
        border-radius: 12px;
        font-size: 1.05rem;
        font-weight: 600;
        margin-bottom: 40px;
        display: none;
        font-family: "Consolas", "Courier New", monospace;
        word-break: break-all;
      }
      .result.visible {
        display: block;
        background: rgba(96, 165, 250, 0.12);
        border: 1px solid rgba(96, 165, 250, 0.3);
        color: #93c5fd;
      }

      h2 {
        font-size: 1.2rem;
        color: #cbd5e1;
        margin-bottom: 16px;
      }

      .example-box {
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 12px;
        padding: 20px 24px;
        margin-bottom: 40px;
        font-family: "Consolas", "Courier New", monospace;
        font-size: 0.92rem;
        line-height: 1.8;
        color: #e2e8f0;
      }
      .example-box .label {
        color: #a78bfa;
        font-weight: 600;
      }
      .example-box .arrow {
        color: #60a5fa;
      }

      .code-section h2 {
        margin-bottom: 12px;
      }

      pre {
        background: rgba(0, 0, 0, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 12px;
        padding: 24px;
        overflow-x: auto;
        font-size: 0.88rem;
        line-height: 1.7;
        color: #e2e8f0;
      }

      .kw {
        color: #c084fc;
      }
      .fn {
        color: #60a5fa;
      }
      .str {
        color: #34d399;
      }
      .cm {
        color: #64748b;
      }
      .type {
        color: #fbbf24;
      }

      .test-results {
        background: rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(34, 197, 94, 0.25);
        border-radius: 12px;
        padding: 20px 24px;
        font-family: 'Consolas', 'Courier New', monospace;
        font-size: 0.9rem;
        line-height: 1.8;
      }
      .test-results-header {
        color: #94a3b8;
        margin-bottom: 8px;
      }
      .test-run-label {
        background: #3b82f6;
        color: #fff;
        padding: 2px 8px;
        border-radius: 4px;
        font-weight: 700;
        font-size: 0.8rem;
        margin-right: 8px;
      }
      .test-results-file {
        color: #e2e8f0;
        margin-bottom: 12px;
      }
      .test-pass-icon {
        color: #4ade80;
        font-weight: 700;
        margin-right: 6px;
      }
      .test-count {
        color: #94a3b8;
      }
      .test-time {
        color: #64748b;
      }
      .test-results-summary {
        border-top: 1px solid rgba(255, 255, 255, 0.08);
        padding-top: 12px;
      }
      .test-label-pass {
        color: #94a3b8;
        display: inline-block;
        width: 90px;
      }
      .test-pass-text {
        color: #4ade80;
        font-weight: 600;
      }
    </style>
  </head>
  <body>
    <a class="back-link" href="../index.html">&larr; Back to Questions</a>

    <div class="container">
      <h1>Q3: Autocomplete</h1>
      <p class="description">
        สร้าง function autocomplete ค้นหาคำที่มี search เป็นส่วนหนึ่ง (ignore
        case) แล้วเรียงลำดับตามตำแหน่งที่พบ: ขึ้นต้น &gt; กลางคำ &gt; ท้ายคำ
      </p>

      <div class="form-group">
        <label for="searchInput">search (คำค้นหา)</label>
        <input type="text" id="searchInput" placeholder="เช่น th" />
      </div>

      <div class="form-group">
        <label for="itemsInput">items (คำทั้งหมด คั่นด้วย comma)</label>
        <input
          type="text"
          id="itemsInput"
          placeholder="เช่น Mother, Think, Worthy, Apple, Android"
        />
        <p class="hint">
          กรอกได้ทั้งแบบ Mother, Think, Worthy หรือ ["Mother", "Think",
          "Worthy"]
        </p>
      </div>

      <div class="form-group">
        <label for="maxInput">maxResult (จำนวนผลลัพธ์สูงสุด)</label>
        <input type="number" id="maxInput" value="5" min="0" />
      </div>

      <div class="btn-row">
        <button id="searchBtn" disabled>Search</button>
      </div>

      <div class="result" id="result"></div>

      <h2>Example</h2>
      <div class="example-box">
        <span class="label">input:</span> autocomplete(<span class="str"
          >"th"</span
        >, [<span class="str">"Mother"</span>, <span class="str">"Think"</span>,
        <span class="str">"Worthy"</span>, <span class="str">"Apple"</span>,
        <span class="str">"Android"</span>], 2)<br />
        <span class="label">คำที่มี "th":</span> "Mother", "Think", "Worthy"<br />
        <span class="label">เรียงลำดับ:</span> "Think"
        <span class="cm">(ขึ้นต้น)</span>, "Mother"
        <span class="cm">(กลาง)</span>, "Worthy" <span class="cm">(ท้าย)</span
        ><br />
        <span class="label">maxResult = 2</span>
        <span class="arrow">=></span> [<span class="str">"Think"</span>,
        <span class="str">"Mother"</span>]
      </div>

      <div class="code-section">
        <h2>Source Code</h2>
        <pre><code><span class="cm">/**
 * ฟังก์ชัน autocomplete — ค้นหาคำที่มี search เป็นส่วนหนึ่ง (ignore case)
 * เรียงตาม: ขึ้นต้น → กลางคำ → ท้ายคำ จำกัดจำนวนผลลัพธ์ด้วย maxResult
 *
 * ตัวอย่าง:
 *   autocomplete("th", ["Mother", "Think", "Worthy", "Apple", "Android"], 2)
 *   ผลลัพธ์: ["Think", "Mother"]
 */</span>
<span class="kw">export function</span> <span class="fn">process_pre_interview_Q3</span>(
  search: <span class="type">string</span>,
  items: <span class="type">string</span>[],
  maxResult: <span class="type">number</span>,
): <span class="type">string</span>[] {
  <span class="kw">const</span> searchLower = search.<span class="fn">toLowerCase</span>();

  <span class="cm">// ขั้นตอนที่ 1: กรอง — เอาเฉพาะคำที่มี search อยู่ข้างใน</span>
  <span class="kw">const</span> matched: <span class="type">string</span>[] = [];
  <span class="kw">for</span> (<span class="kw">const</span> item <span class="kw">of</span> items) {
    <span class="kw">if</span> (item.<span class="fn">toLowerCase</span>().<span class="fn">includes</span>(searchLower)) {
      matched.<span class="fn">push</span>(item);
    }
  }

  <span class="cm">// ขั้นตอนที่ 2: แบ่งเป็น 3 กลุ่มตามตำแหน่งที่พบ</span>
  <span class="kw">const</span> startsWith: <span class="type">string</span>[] = []; <span class="cm">// search อยู่ต้นคำ   เช่น "Think"</span>
  <span class="kw">const</span> middle: <span class="type">string</span>[] = [];     <span class="cm">// search อยู่กลางคำ  เช่น "Mother"</span>
  <span class="kw">const</span> endsWith: <span class="type">string</span>[] = [];   <span class="cm">// search อยู่ท้ายคำ   เช่น "Growth"</span>

  <span class="kw">for</span> (<span class="kw">const</span> item <span class="kw">of</span> matched) {
    <span class="kw">const</span> index = item.<span class="fn">toLowerCase</span>().<span class="fn">indexOf</span>(searchLower);

    <span class="kw">if</span> (index === 0) {
      startsWith.<span class="fn">push</span>(item);
    } <span class="kw">else if</span> (index + searchLower.length === item.length) {
      endsWith.<span class="fn">push</span>(item);
    } <span class="kw">else</span> {
      middle.<span class="fn">push</span>(item);
    }
  }

  <span class="cm">// ขั้นตอนที่ 3: เรียงตัวอักษรภายในแต่ละกลุ่ม</span>
  startsWith.<span class="fn">sort</span>((a, b) => a.<span class="fn">localeCompare</span>(b));
  middle.<span class="fn">sort</span>((a, b) => a.<span class="fn">localeCompare</span>(b));
  endsWith.<span class="fn">sort</span>((a, b) => a.<span class="fn">localeCompare</span>(b));

  <span class="cm">// ขั้นตอนที่ 4: รวมกลุ่ม ขึ้นต้น → กลาง → ท้าย แล้วตัดตาม maxResult</span>
  <span class="kw">const</span> result = [...startsWith, ...middle, ...endsWith];
  <span class="kw">return</span> result.<span class="fn">slice</span>(0, maxResult);
}</code></pre>
      </div>

      <div class="code-section" style="margin-top: 40px">
        <h2>Test Results</h2>
        <div class="test-results">
          <div class="test-results-header">
            <span class="test-run-label">RUN</span> v4.0.18
          </div>
          <div class="test-results-file">
            <span class="test-pass-icon">&#10003;</span> pre-interview/src/question3.test.ts <span class="test-count">(12 tests)</span> <span class="test-time">26ms</span>
          </div>
          <div class="test-results-summary">
            <div><span class="test-label-pass">Test Files</span> <span class="test-pass-text">1 passed</span> (1)</div>
            <div><span class="test-label-pass">Tests</span> <span class="test-pass-text">12 passed</span> (12)</div>
          </div>
        </div>
      </div>

      <div class="code-section" style="margin-top: 40px">
        <h2>Test Code</h2>
        <pre><code><span class="kw">import</span> { describe, it, expect } <span class="kw">from</span> <span class="str">"vitest"</span>;
<span class="kw">import</span> { process_pre_interview_Q3 } <span class="kw">from</span> <span class="str">"./question3.js"</span>;

<span class="fn">describe</span>(<span class="str">"process_pre_interview_Q3"</span>, () => {
  <span class="kw">const</span> sampleItems = [<span class="str">"Mother"</span>, <span class="str">"Think"</span>, <span class="str">"Worthy"</span>, <span class="str">"Apple"</span>, <span class="str">"Android"</span>];

  <span class="fn">it</span>(<span class="str">'ตัวอย่างจากโจทย์ — autocomplete("th", items, 2) => ["Think", "Mother"]'</span>, () => {
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"th"</span>, sampleItems, 2))
      .<span class="fn">toEqual</span>([<span class="str">"Think"</span>, <span class="str">"Mother"</span>]);
  });

  <span class="fn">it</span>(<span class="str">"ไม่จำกัดผลลัพธ์ — ได้ครบทุกคำที่ตรง เรียงตาม ขึ้นต้น > กลาง > ท้าย"</span>, () => {
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"th"</span>, sampleItems, 10))
      .<span class="fn">toEqual</span>([<span class="str">"Think"</span>, <span class="str">"Mother"</span>, <span class="str">"Worthy"</span>]);
  });

  <span class="fn">it</span>(<span class="str">"ค้นหาแบบ ignore case — ตัวเล็กตัวใหญ่ไม่มีผล"</span>, () => {
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"TH"</span>, sampleItems, 10))
      .<span class="fn">toEqual</span>([<span class="str">"Think"</span>, <span class="str">"Mother"</span>, <span class="str">"Worthy"</span>]);
  });

  <span class="fn">it</span>(<span class="str">"ไม่พบผลลัพธ์ — คืน array ว่าง"</span>, () => {
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"xyz"</span>, sampleItems, 5))
      .<span class="fn">toEqual</span>([]);
  });

  <span class="fn">it</span>(<span class="str">"maxResult = 0 — คืน array ว่าง"</span>, () => {
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"th"</span>, sampleItems, 0))
      .<span class="fn">toEqual</span>([]);
  });

  <span class="fn">it</span>(<span class="str">"คำที่ search อยู่ท้ายคำ — มาหลังสุด"</span>, () => {
    <span class="kw">const</span> items = [<span class="str">"Growth"</span>, <span class="str">"Think"</span>, <span class="str">"Mother"</span>];
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"th"</span>, items, 10))
      .<span class="fn">toEqual</span>([<span class="str">"Think"</span>, <span class="str">"Mother"</span>, <span class="str">"Growth"</span>]);
  });

  <span class="fn">it</span>(<span class="str">"เรียงลำดับ: ขึ้นต้น > กลาง > ท้าย ครบทั้ง 3 กลุ่ม"</span>, () => {
    <span class="kw">const</span> items = [<span class="str">"Growth"</span>, <span class="str">"Python"</span>, <span class="str">"Theater"</span>, <span class="str">"Math"</span>];
    <span class="cm">// Theater = ขึ้นต้น, Python = กลาง, Growth/Math = ท้าย (เรียงตัวอักษร)</span>
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"th"</span>, items, 10))
      .<span class="fn">toEqual</span>([<span class="str">"Theater"</span>, <span class="str">"Python"</span>, <span class="str">"Growth"</span>, <span class="str">"Math"</span>]);
  });

  <span class="fn">it</span>(<span class="str">"กลุ่มเดียวกัน ตำแหน่งเดียวกัน — เรียงตามตัวอักษร"</span>, () => {
    <span class="kw">const</span> items = [<span class="str">"Ether"</span>, <span class="str">"Athena"</span>, <span class="str">"Other"</span>];
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"th"</span>, items, 10))
      .<span class="fn">toEqual</span>([<span class="str">"Athena"</span>, <span class="str">"Ether"</span>, <span class="str">"Other"</span>]);
  });

  <span class="fn">it</span>(<span class="str">"search เป็น string ว่าง — ทุกคำ match เรียงตามตัวอักษร"</span>, () => {
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">""</span>, sampleItems, 3))
      .<span class="fn">toEqual</span>([<span class="str">"Android"</span>, <span class="str">"Apple"</span>, <span class="str">"Mother"</span>]);
  });

  <span class="fn">it</span>(<span class="str">"items เป็น array ว่าง — คืน array ว่าง"</span>, () => {
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"th"</span>, [], 5))
      .<span class="fn">toEqual</span>([]);
  });

  <span class="fn">it</span>(<span class="str">"maxResult = 1 — ได้แค่ตัวแรกที่ตรงที่สุด"</span>, () => {
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"th"</span>, sampleItems, 1))
      .<span class="fn">toEqual</span>([<span class="str">"Think"</span>]);
  });

  <span class="fn">it</span>(<span class="str">"ค้นหาคำเต็ม — ต้องเจอตัวเอง"</span>, () => {
    <span class="fn">expect</span>(<span class="fn">process_pre_interview_Q3</span>(<span class="str">"Apple"</span>, sampleItems, 5))
      .<span class="fn">toEqual</span>([<span class="str">"Apple"</span>]);
  });
});</code></pre>
      </div>
    </div>

    <script>
      // =============================================
      // ฟังก์ชัน autocomplete (เหมือนกับ question3.ts)
      // =============================================

      function process_pre_interview_Q3(search, items, maxResult) {
        const searchLower = search.toLowerCase();

        // ขั้นตอนที่ 1: กรอง — เอาเฉพาะคำที่มี search อยู่ข้างใน
        const matched = [];
        for (const item of items) {
          if (item.toLowerCase().includes(searchLower)) {
            matched.push(item);
          }
        }

        // ขั้นตอนที่ 2: แบ่งเป็น 3 กลุ่มตามตำแหน่งที่พบ
        const startsWith = []; // search อยู่ต้นคำ   เช่น "Think"
        const middle = [];     // search อยู่กลางคำ  เช่น "Mother"
        const endsWith = [];   // search อยู่ท้ายคำ   เช่น "Growth"

        for (const item of matched) {
          const index = item.toLowerCase().indexOf(searchLower);

          if (index === 0) {
            startsWith.push(item);
          } else if (index + searchLower.length === item.length) {
            endsWith.push(item);
          } else {
            middle.push(item);
          }
        }

        // ขั้นตอนที่ 3: เรียงตัวอักษรภายในแต่ละกลุ่ม
        startsWith.sort((a, b) => a.localeCompare(b));
        middle.sort((a, b) => a.localeCompare(b));
        endsWith.sort((a, b) => a.localeCompare(b));

        // ขั้นตอนที่ 4: รวมกลุ่ม ขึ้นต้น → กลาง → ท้าย แล้วตัดตาม maxResult
        const result = [...startsWith, ...middle, ...endsWith];
        return result.slice(0, maxResult);
      }

      // =============================================
      // DOM Elements
      // =============================================
      const searchInput = document.getElementById("searchInput");
      const itemsInput = document.getElementById("itemsInput");
      const maxInput = document.getElementById("maxInput");
      const searchBtn = document.getElementById("searchBtn");
      const resultEl = document.getElementById("result");

      // =============================================
      // validate: เรียกทุกครั้งที่ผู้ใช้พิมพ์
      // - ต้องมี search และ items ถึงจะกด Search ได้
      // =============================================
      function validate() {
        searchBtn.disabled =
          searchInput.value.trim().length === 0 ||
          itemsInput.value.trim().length === 0;
      }

      // =============================================
      // doSearch: เรียกเมื่อกดปุ่ม Search
      // - parse items จาก input (รองรับทั้ง comma-separated และ JSON format)
      // - เรียก process_pre_interview_Q3
      // - แสดงผลลัพธ์
      // =============================================
      function doSearch() {
        const search = searchInput.value;
        const rawItems = itemsInput.value.trim();
        const maxResult = parseInt(maxInput.value) || 0;

        // ลบ [ ] " ' ออก แล้วแยกด้วย comma
        const cleaned = rawItems.replace(/[\[\]"']/g, "");
        const items = cleaned
          .split(",")
          .map((s) => s.trim())
          .filter((s) => s.length > 0);

        const result = process_pre_interview_Q3(search, items, maxResult);

        resultEl.className = "result visible";
        resultEl.textContent =
          result.length > 0
            ? `[${result.map((s) => `"${s}"`).join(", ")}]`
            : "[] (ไม่พบผลลัพธ์)";
      }

      // =============================================
      // Event Listeners
      // =============================================
      searchInput.addEventListener("input", validate);
      itemsInput.addEventListener("input", validate);
      searchBtn.addEventListener("click", doSearch);
      // กด Enter ที่ช่องไหนก็ได้ → doSearch
      [searchInput, itemsInput, maxInput].forEach((el) => {
        el.addEventListener("keydown", (e) => {
          if (e.key === "Enter" && !searchBtn.disabled) doSearch();
        });
      });
    </script>
  </body>
</html>
